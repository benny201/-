# 域名系统DNS

## 概述
DNS（Domain Name System）：因特网使用的命名系统，将机器名字转换为IP地址。

### 为什么IP层不适用DNS？
因为IP长度是固定的：IPV4: 32位／IPV6:128位，但是域名长度不固定，不好处理。

### DNS
* DNS被设置成一个联机分布式数据库系统，采用客户／服务器方式，使大多数名字都在本地进行解析。
* 域名道IP地址的解析是由分布在因特网上的域名服务器（域名服务程序）共同完成。
* 域名道IP地址的解析过程：
```
域名需要解析位IP地址是，调用`解析程序（resolver）`，并成为一个DNS的客户。
把带解析的域名放在DNS请求报文中，以UDP用户数据报方式发给本地域名服务器（UPD减少开销），
本地域名服务器在查找域名后，把对应的IP地址放在回答报文中返回。
```
## 域名结构
层次树状结构的命名方法。
每个域名都有标号序列组成。
mail.cctv.com(三级域名.二级域名.顶级域名)
不区分大小写，每个标号不超过63个字符，不规定一个域名需要包含多少个下级域名
首先是根域名，但是根域名没有对应的名字，根下面一级是顶级域名，然后一直往下划分。

## 域名服务器
DNS服务器的管辖范围不是以域为单位，而是以区为单位。一个服务器所负责管辖的范围叫做区（ZONE）。
可以将域名服务器分为一下四种不同的类型：
* 根域名服务器（root name server）：
  ```
  所有根域名服务器都知道所有的顶级域名服务器的域名和IP地址。
  只要本地域名服务器不能解析，就首先要求助于根域名服务器。根域名服务器都瘫痪的话，整个DNS系统就无法工作。
  总有13个不同IP地址的根域名服务器：a-m －> a.rootservers.net...
  查找时，从离客户最近的根域名服务器查找（任播技术anycast）
  ```
* 顶级域名服务器（TLD）：
  ```
  给出相应回答，然后继续从下一个域名服务器进一步查找。也可能是最后的结果
  ```
* 权限域名服务器：
```
负责一个区的域名服务器。当一个权限域名服务器还给不出答案，就找下一个。
```
* 本地域名服务器(local name server)：
```
本地域名服务器离用户较近，一般不超过几个路由器。直接查询，不需要区询问其他服务器。
为了可靠性，会设置一个主域名服务器(master name server)，还会设置一个辅助域名服务器(secondary name server)
```

## 解析的过程
* 主机向本地域名服务器的查询一半都是采用`递归查询(recursive query)`：
```
如果主机所询问的本地域名服务器不知道被查询域名的IP地址，那么本地域名服务器就以DNS客户的身份，向其他根域名服务器发出查询报文。
```
* 本地域名服务器向根域名服务器查询采用`迭代查询(iterative query)`：
```
当根域名服务器收到本地域名服务器发送的迭代查询请求豹纹是，要么给对IP地址，要么告诉它：下一向哪一个服务器查询，
然后让本地服务器继续向那个服务器查询。
```
* 为了提高DNS查询效率，并减轻根域名服务器的负荷，在域名服务器中使用了`高速缓存`，用来存储最近查询过的域名以及从何处获得域名映射信息的记录。
